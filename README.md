# MotoRoller: Motorola GM remote control

MotoRoller - кроссплатформенный веб-сервер с открытым исходным кодом, созданный силами сообщества Satcom Pirates.

На сегодняшний день поддерживается:
- управление радиостанциями Motorola GM 1280, GM360 с зонами
- голосовой траффик через WebRTC в браузерах Firefox & Chrome
- работа на одноплатных компьютерах, в частности на Orange PI Zero 2

https://user-images.githubusercontent.com/90838159/186971130-ab151ed4-0c0b-4ded-856b-98d162e6c4db.mp4

Для работы веб-сервера требуется dotnet runtime. Установите dotnet runtime под вашу ОС (Linux/Windows) https://dotnet.microsoft.com/en-us/download/dotnet
## Быстрый старт (только управление, без звука)
- Подключите программатор к станции и компьютеру
- Скачайте и распакуйте архив
- Откройте appsettings.json любым текстовым редактором
- В строке "SerialPort": укажите порт, к которому подключен программатор станции. Пример для windows "SerialPort":"COM6", для linux "SerialPort": "/dev/ttyS1"
- Откройте командную строку или терминал.
- Запустите программу командой dotnet MotoRoller.dll --urls [http://0.0.0.0:80](http://0.0.0.0/) , где 80 - порт на котором будет запущен веб-сервер. Можно использовать другой порт по вашему усмотрению.
- Включите радиостанцию.
- Откройте браузер по адресу http://localhost/

Управление функционалом станции происходит по шине BUS+. Подключиться к ней можно двумя способами: 
 - через задний аксессуарный разъем,
 - через фронтальный разъем.
 
Аудио сигналы по этой шине не передаются.

## Коммутация аудио цепей
Для того, чтобы работали звуковые функции, потребуется сигнал с аудиовыхода станции подать на микрофонный либо линейный вход звуковой карты компьютера (сервера). В свою очередь  сигнал с аудио выхода звуковой карты компьютера подать на микрофонный вход станции. Важным моментом является то, что сигнал на микрофонный вход станции требуется подать именно на передний разъем станции. Эта особенность связана с тем, что при подаче команды PTT по Data-кабелю (через BUS+), включается вход микрофона только на передней панели.
Можно использовать на компьютере звуковую карту как с тремя разъемами (в этом случае используются разъемы "Line in" и "Line out"), так и с двумя разъемами (в этом случае используются разъемы "Mic" и "Line out").

Чтобы подключиться к аудио точкам фронтального разъема, гнездо можно вынести на кабельной сборке, состоящей из отрезка кабеля UTP 4p и двух разъемов RG-45 (мама и папа). Для таких целей можно использовать внутренности компьютерной LAN розетки.

![изображение](https://user-images.githubusercontent.com/90838159/211718471-8a979c83-6b3c-43c1-b774-15e6217f3706.png)
![изображение](https://user-images.githubusercontent.com/90838159/211718509-4b6dc211-ec7c-4f8b-b254-c9760f43513b.png)
![изображение](https://user-images.githubusercontent.com/90838159/211718535-7a7676b3-6488-408b-ba99-82a73da2af32.png)

В случае если в качестве сервера используется компьютер, у которого один единственный совмещенный аудио разъем, то для сборки аудио кабеля используется 4-х контактный jack-разъем (как на фото выше). В этом случае распайка будет следующая:

![изображение](https://user-images.githubusercontent.com/90838159/211721823-f591e6ee-8b24-4020-b189-dfd1ecb783ee.png)


Чтобы веб-сервер был доступен из интернета настройте файрвол вашей ОС и роутер. Пользователям роутеров Keenetic крайне рекомендую фичу KeenDNS.
Скачать последнюю версию можно здесь https://github.com/satcom-uhf/MotoRoller/releases

Сначала запускаем ПО, только потом включаем станцию! Если программатор подключен к ПК/Raspberry но данные из порта никто не читает (не запущено ПО), станция может перестать отзываться на клавиши, это обычное и нормальное поведение. 

Особая благодарность:

YAMAL - идея, теоретическая подготовка, Motorola Confidential Proprietary документация

TURBINA, 999 - тестирование

OBERON, Oxotnuk и Радуга - за предоставленное оборудование
